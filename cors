import org.springframework.context.annotation.Bean;
import org.springframework.context.annotation.Configuration;
import org.springframework.web.servlet.config.annotation.CorsRegistry;
import org.springframework.web.servlet.config.annotation.WebMvcConfigurer;

@Configuration
public class CorsConfig {

    @Bean
    public WebMvcConfigurer corsConfigurer() {
        return new WebMvcConfigurer() {
            @Override
            public void addCorsMappings(CorsRegistry registry) {
                registry.addMapping("/**") // Apply to all endpoints (e.g., /api/login, /api/claims)
                        .allowedOrigins("http://localhost:4200") // The exact URL of your Angular app
                        .allowedMethods("GET", "POST", "PUT", "DELETE", "OPTIONS") // Allowed HTTP methods
                        .allowedHeaders("*") // Allow all headers
                        .allowCredentials(true); // Needed if you use sessions or cookies later
            }
        };
    }
}
--------------
import { Injectable } from '@angular/core';
import { HttpClient } from '@angular/common/http';
import { Observable } from 'rxjs';

@Injectable({
  providedIn: 'root'
})
export class ApiService {
  
  private baseUrl = 'http://localhost:8080/api'; 

  constructor(private http: HttpClient) { }

  // NEW: Login API Call
  login(credentials: any): Observable<any> {
    // Sends the username, password, and role to Spring Boot
    return this.http.post(`${this.baseUrl}/auth/login`, credentials);
  }

  submitClaim(claimData: any): Observable<any> {
    return this.http.post(`${this.baseUrl}/claims`, claimData);
  }
}

--------------


import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';
import { Router, RouterLink } from '@angular/router';
import { Card } from 'primeng/card';
import { InputText } from 'primeng/inputtext';
import { Password } from 'primeng/password';
import { Button } from 'primeng/button';
import { Select } from 'primeng/select';
import { AuthService } from '../auth.service';
import { ApiService } from '../../../core/services/api.service'; // <--- 1. Import ApiService

@Component({
  selector: 'app-login',
  standalone: true,
  imports: [CommonModule, ReactiveFormsModule, RouterLink, Card, InputText, Password, Button, Select],
  templateUrl: './login.component.html',
  styleUrl: './login.component.scss'
})
export class LoginComponent {
  loginForm: FormGroup;
  
  roles = [
    { label: 'Approver', value: 'Approver' },
    { label: 'User', value: 'User' },
    { label: 'Read-Only', value: 'Read-Only' },
    { label: 'Super-user', value: 'Super-user' }
  ];

  // 2. Inject ApiService into the constructor
  constructor(
    private fb: FormBuilder, 
    private router: Router, 
    private authService: AuthService,
    private apiService: ApiService
  ) {
    this.loginForm = this.fb.group({
      role: ['', Validators.required],
      username: ['', Validators.required],
      password: ['', Validators.required]
    });
  }

  onSubmit() {
    if (this.loginForm.valid) {
      const loginPayload = this.loginForm.value; // Grabs { role, username, password }

      // 3. Make the actual HTTP POST request to Spring Boot
      this.apiService.login(loginPayload).subscribe({
        
        next: (response) => {
          // SUCCESS! Spring Boot said the password is correct.
          console.log('Backend Response:', response);
          
          // Save the role to our local state so the dashboard builds the right menus
          this.authService.setRole(loginPayload.role);
          
          // Now we are allowed to enter the dashboard
          this.router.navigate(['/dashboard']); 
        },
        
        error: (err) => {
          // FAILURE! Spring Boot rejected the login or the server is off.
          console.error('Login Failed:', err);
          alert('Login failed! Please check your credentials or ensure the backend is running.');
        }
      });

    } else {
      this.loginForm.markAllAsTouched(); 
    }
  }
}
-----------
onSubmit() {
    if (this.loginForm.valid) {
      const loginPayload = this.loginForm.value;
      console.log('Sending to Backend:', loginPayload);

      // 3. The Real Backend Connection
      this.apiService.login(loginPayload).subscribe({
        next: (response) => {
          // SUCCESS: The backend accepted the credentials
          console.log('Login Success:', response);
          
          // Save the role and go to dashboard
          this.authService.setRole(loginPayload.role);
          this.router.navigate(['/dashboard']); 
        },
        error: (error) => {
          // FAILURE: Backend rejected it or is offline
          console.error('Login Failed:', error);
          alert('Login Failed! Check if Spring Boot is running on port 8080.');
        }
      });
      
    } else {
      this.loginForm.markAllAsTouched();
    }
  }
}

------


import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators, AbstractControl, ValidationErrors } from '@angular/forms';
import { Router, RouterLink } from '@angular/router';
import { Card } from 'primeng/card';
import { InputText } from 'primeng/inputtext';
import { Password } from 'primeng/password';
import { Button } from 'primeng/button';
import { Select } from 'primeng/select';
import { ApiService } from '../../../core/services/api.service';

@Component({
  selector: 'app-signup',
  standalone: true,
  imports: [CommonModule, ReactiveFormsModule, RouterLink, Card, InputText, Password, Button, Select],
  templateUrl: './signup.component.html',
  styleUrl: './signup.component.scss'
})
export class SignupComponent {
  signupForm: FormGroup;
  
  // The roles they can request to join as
  roles = [
    { label: 'User', value: 'User' },
    { label: 'Approver', value: 'Approver' },
    { label: 'Read-Only', value: 'Read-Only' }
  ];

  constructor(private fb: FormBuilder, private apiService: ApiService, private router: Router) {
    this.signupForm = this.fb.group({
      fullName: ['', Validators.required],
      email: ['', [Validators.required, Validators.email]],
      role: ['', Validators.required],
      password: ['', [Validators.required, Validators.minLength(6)]],
      confirmPassword: ['', Validators.required]
    }, { validators: this.passwordMatchValidator });
  }

  // Custom validator to ensure passwords match
  passwordMatchValidator(control: AbstractControl): ValidationErrors | null {
    const password = control.get('password')?.value;
    const confirmPassword = control.get('confirmPassword')?.value;
    if (password !== confirmPassword) {
      control.get('confirmPassword')?.setErrors({ passwordMismatch: true });
      return { passwordMismatch: true };
    }
    return null;
  }

  onSubmit() {
    if (this.signupForm.valid) {
      // Remove confirmPassword before sending to backend
      const { confirmPassword, ...userData } = this.signupForm.value;
      
      this.apiService.register(userData).subscribe({
        next: (response) => {
          alert('Registration successful! Please wait for a Super-user to activate your account.');
          this.router.navigate(['/login']);
        },
        error: (err) => {
          console.error('Signup Failed:', err);
          alert('Registration failed. Email might already be in use.');
        }
      });
    } else {
      this.signupForm.markAllAsTouched();
    }
  }
}
------
import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';
import { Router, RouterLink } from '@angular/router';
import { Card } from 'primeng/card';
import { InputText } from 'primeng/inputtext';
import { Password } from 'primeng/password';
import { Button } from 'primeng/button';
import { Select } from 'primeng/select';
import { ApiService } from '../../../core/services/api.service';

@Component({
  selector: 'app-signup',
  standalone: true,
  imports: [CommonModule, ReactiveFormsModule, RouterLink, Card, InputText, Password, Button, Select],
  templateUrl: './signup.component.html',
  styleUrl: './signup.component.scss'
})
export class SignupComponent {
  signupForm: FormGroup;
  
  roles = [
    { label: 'User', value: 'User' },
    { label: 'Approver', value: 'Approver' },
    { label: 'Read-Only', value: 'Read-Only' }
  ];

  constructor(private fb: FormBuilder, private apiService: ApiService, private router: Router) {
    this.signupForm = this.fb.group({
      fullName: ['', Validators.required],
      email: ['', [Validators.required, Validators.email]],
      role: ['', Validators.required],
      password: ['', [Validators.required, Validators.minLength(6)]]
    });
  }

  onSubmit() {
    if (this.signupForm.valid) {
      // Send the form data directly to the backend
      console.log('Sending Signup Data:', this.signupForm.value);
      
      this.apiService.register(this.signupForm.value).subscribe({
        next: (response) => {
          alert('Registration successful! Please wait for a Super-user to activate your account.');
          this.router.navigate(['/login']);
        },
        error: (err) => {
          console.error('Signup Failed:', err);
          alert('Registration failed. Email might already be in use.');
        }
      });
    } else {
      this.signupForm.markAllAsTouched();
    }
  }
}

---

<div class="auth-container" style="display: flex; justify-content: center; align-items: center; min-height: 100vh; background-color: #f4f6f8;">
  <p-card styleClass="auth-card" [style]="{ width: '450px', padding: '1rem', boxShadow: '0 4px 12px rgba(0,0,0,0.1)', borderRadius: '12px' }">
    
    <div class="text-center" style="text-align: center; margin-bottom: 2rem;">
      <h2 style="color: #00915a; margin-bottom: 0.5rem;">Create an Account</h2>
      <p style="color: #666; margin-top: 0;">Register for the BNP Insurance Portal</p>
    </div>

    <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="p-fluid" style="display: flex; flex-direction: column; gap: 1.25rem;">
      
      <div class="field">
        <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Full Name *</label>
        <input pInputText formControlName="fullName" placeholder="John Doe" />
        <small class="p-error" *ngIf="signupForm.get('fullName')?.invalid && signupForm.get('fullName')?.touched">Name is required.</small>
      </div>

      <div class="field">
        <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Email Address *</label>
        <input pInputText formControlName="email" type="email" placeholder="john@example.com" />
        <small class="p-error" *ngIf="signupForm.get('email')?.invalid && signupForm.get('email')?.touched">Valid email is required.</small>
      </div>

      <div class="field">
        <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Requested Role *</label>
        <p-select formControlName="role" [options]="roles" placeholder="Select Role" styleClass="w-full"></p-select>
        <small class="p-error" *ngIf="signupForm.get('role')?.invalid && signupForm.get('role')?.touched">Role selection is required.</small>
      </div>

      <div class="field">
        <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Password *</label>
        <p-password formControlName="password" [toggleMask]="true" [feedback]="true" placeholder="Min 6 characters"></p-password>
        <small class="p-error" *ngIf="signupForm.get('password')?.invalid && signupForm.get('password')?.touched">Password must be at least 6 characters.</small>
      </div>

      <p-button label="Sign Up" type="submit" styleClass="p-button-success w-full" style="margin-top: 1rem;"></p-button>

    </form>

    <div style="text-align: center; margin-top: 1.5rem; font-size: 0.9rem; color: #666;">
      Already have an account? <a routerLink="/login" style="color: #00915a; font-weight: 600; text-decoration: none;">Log In here</a>
    </div>

  </p-card>
</div>

-----------

<div class="flex align-items-center justify-content-center min-h-screen">
  <p-card header="Create an Account" [style]="{ width: '400px' }">
    
    <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="p-fluid">
      
      <div class="field mb-3">
        <label for="fullName" class="font-semibold">Full Name *</label>
        <input id="fullName" type="text" pInputText formControlName="fullName" placeholder="Enter your name" />
        <small class="p-error" *ngIf="signupForm.get('fullName')?.invalid && signupForm.get('fullName')?.touched">Name is required.</small>
      </div>

      <div class="field mb-3">
        <label for="email" class="font-semibold">Email *</label>
        <input id="email" type="email" pInputText formControlName="email" placeholder="Enter your email" />
        <small class="p-error" *ngIf="signupForm.get('email')?.invalid && signupForm.get('email')?.touched">Valid email is required.</small>
      </div>

      <div class="field mb-3">
        <label for="role" class="font-semibold">Requested Role *</label>
        <p-select id="role" formControlName="role" [options]="roles" placeholder="Select Role" appendTo="body"></p-select>
        <small class="p-error" *ngIf="signupForm.get('role')?.invalid && signupForm.get('role')?.touched">Role is required.</small>
      </div>

      <div class="field mb-4">
        <label for="password" class="font-semibold">Password *</label>
        <p-password id="password" formControlName="password" [toggleMask]="true" [feedback]="false" placeholder="Min 6 characters"></p-password>
        <small class="p-error" *ngIf="signupForm.get('password')?.invalid && signupForm.get('password')?.touched">Password must be at least 6 characters.</small>
      </div>

      <p-button label="Sign Up" type="submit" [disabled]="signupForm.invalid" styleClass="w-full"></p-button>

    </form>

    <div class="text-center mt-4" style="font-size: 0.9rem;">
      <span class="text-500">Already have an account? </span>
      <a routerLink="/login" class="text-primary font-semibold no-underline">Log In</a>
    </div>

  </p-card>
</div>
--------

import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';
import { Router, RouterLink } from '@angular/router';
import { Card } from 'primeng/card';
import { InputText } from 'primeng/inputtext';
import { Password } from 'primeng/password';
import { Button } from 'primeng/button';
import { Select } from 'primeng/select';
import { ApiService } from '../../../core/services/api';

@Component({
  selector: 'app-signup',
  standalone: true,
  templateUrl: './signup.html',
  styleUrl: './signup.scss',
  imports: [CommonModule, ReactiveFormsModule, RouterLink, Card, InputText, Password, Button, Select]
})
export class SignupComponent {
  signupForm: FormGroup;

  roles = [
    { label: 'User', value: 'User' },
    { label: 'Approver', value: 'Approver' },
    { label: 'Read-Only', value: 'Read-Only' }
  ];

  constructor(private fb: FormBuilder, private apiService: ApiService, private router: Router) {
    this.signupForm = this.fb.group({
      fullName: ['', Validators.required],
      email: ['', [Validators.required, Validators.email]],
      role: ['', Validators.required],
      password: ['', [Validators.required, Validators.minLength(6)]]
    });
  }

  onSubmit() {
    if (this.signupForm.valid) {
      console.log('Sending Signup Data:', this.signupForm.value);
      
      this.apiService.signup(this.signupForm.value).subscribe({
        next: (response) => {
          alert('Registration successful! Please wait for a Super-user to activate your account.');
          this.router.navigate(['/login']);
        },
        error: (err) => {
          console.error('Signup Failed:', err);
          alert('Registration failed. Email might already be in use.');
        }
      });
    } else {
      this.signupForm.markAllAsTouched();
    }
  }
}
-------

<div class="login-container">
  
  <div class="branding-section">
    <div class="logo-placeholder">
      <i class="pi pi-user-plus" style="font-size: 4rem; margin-bottom: 1rem;"></i>
      <h1>Join the Portal</h1>
      <p>Request access to the Policy & Claims system.</p>
    </div>
  </div>

  <div class="form-section">
    <p-card [style]="{ width: '100%', maxWidth: '32rem', border: 'none', boxShadow: 'none' }">
      
      <div style="text-align: center; margin-bottom: 2rem;">
        <h2 style="margin: 0; font-size: 1.8rem; color: #333;">Create Account</h2>
        <p style="color: #6c757d; margin-top: 0.5rem;">Fill in your details to register.</p>
      </div>

      <form [formGroup]="signupForm" (ngSubmit)="onSubmit()" class="login-form">
        
        <div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="name" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Full Name <span class="required-asterisk" style="color: red;">*</span></label>
          <input pInputText id="name" formControlName="name" placeholder="Enter your full name" class="w-full" />
          <small class="p-error" *ngIf="signupForm.get('name')?.invalid && signupForm.get('name')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Name is required.</small>
        </div>

        <div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="email" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Email Address <span class="required-asterisk" style="color: red;">*</span></label>
          <input pInputText id="email" type="email" formControlName="email" placeholder="Enter your email" class="w-full" />
          <small class="p-error" *ngIf="signupForm.get('email')?.hasError('required') && signupForm.get('email')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Email is required.</small>
          <small class="p-error" *ngIf="signupForm.get('email')?.hasError('email') && signupForm.get('email')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Enter a valid email address.</small>
        </div>

        <div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="role" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Requested Role <span class="required-asterisk" style="color: red;">*</span></label>
          <p-select formControlName="role" [options]="roles" optionLabel="label" optionValue="value" placeholder="Select a Role" styleClass="w-full"></p-select>
          <small class="p-error" *ngIf="signupForm.get('role')?.invalid && signupForm.get('role')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Role is required.</small>
        </div>

        <div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="username" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Username <span class="required-asterisk" style="color: red;">*</span></label>
          <input pInputText id="username" formControlName="username" placeholder="Choose a username" class="w-full" />
          <small class="p-error" *ngIf="signupForm.get('username')?.invalid && signupForm.get('username')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Username is required.</small>
        </div>

        <div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="password" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Password <span class="required-asterisk" style="color: red;">*</span></label>
          <p-password formControlName="password" [toggleMask]="true" [feedback]="true" placeholder="Create a password" styleClass="w-full" inputStyleClass="w-full"></p-password>
          <small class="p-error" *ngIf="signupForm.get('password')?.invalid && signupForm.get('password')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Password is required.</small>
        </div>

        <p-button label="Sign Up" type="submit" [disabled]="signupForm.invalid" styleClass="w-full" [style]="{'margin-top': '1rem'}"></p-button>

        <div style="text-align: center; margin-top: 1.5rem;">
          <span style="color: #6c757d;">Already have an account? </span>
          <a routerLink="/login" style="color: #00915a; font-weight: 600; text-decoration: none; cursor: pointer;">Login here</a>
        </div>

      </form>
    </p-card>
  </div>
</div>
-------
constructor(private fb: FormBuilder, private apiService: ApiService, private router: Router) {
    this.signupForm = this.fb.group({
      name: ['', Validators.required],             // Matches formControlName="name"
      email: ['', [Validators.required, Validators.email]], 
      role: ['', Validators.required],             
      username: ['', Validators.required],         // Matches formControlName="username"
      password: ['', [Validators.required, Validators.minLength(6)]] 
    });
  }
----------

import { inject } from '@angular/core';
import { CanActivateFn, Router } from '@angular/router';
import { AuthService } from '../../features/auth/auth.service';

export const authGuard: CanActivateFn = (route, state) => {
  // We use inject() instead of a constructor for functional guards
  const authService = inject(AuthService);
  const router = inject(Router);

  // If they have a role, let them pass
  if (authService.getRole()) {
    return true; 
  }

  // If they don't have a role, kick them to login and block the route
  router.navigate(['/login']);
  return false; 
};

---------
import { Routes } from '@angular/router';
import { authGuard } from './core/guards/auth.guard'; // <--- 1. Import the guard

export const routes: Routes = [
  { 
    path: 'login', 
    loadComponent: () => import('./features/auth/login/login.component').then(m => m.LoginComponent) 
  },
  { 
    path: 'signup', 
    loadComponent: () => import('./features/auth/signup/signup.component').then(m => m.SignupComponent) 
  },
  { 
    path: 'dashboard', 
    loadComponent: () => import('./features/dashboard/layout/layout.component').then(m => m.LayoutComponent),
    canActivate: [authGuard], // <--- 2. Add the bouncer here! It protects the layout and ALL children.
    children: [
      { path: 'policies', loadComponent: () => import('./features/dashboard/policy-list/policy-list.component').then(m => m.PolicyListComponent) },
      { path: 'apply-claim', loadComponent: () => import('./features/dashboard/apply-claim/apply-claim.component').then(m => m.ApplyClaimComponent) },
      { path: 'approve-claim', loadComponent: () => import('./features/dashboard/approve-claim/approve-claim.component').then(m => m.ApproveClaimComponent) },
      { path: 'create-policy', loadComponent: () => import('./features/dashboard/create-policy/create-policy.component').then(m => m.CreatePolicyComponent) },
      { path: 'manage-users', loadComponent: () => import('./features/dashboard/manage-users/manage-users.component').then(m => m.ManageUsersComponent) },
      { path: '', redirectTo: 'policies', pathMatch: 'full' }
    ]
  },
  { path: '', redirectTo: 'login', pathMatch: 'full' }
];

---------

ngOnInit() {
    // We only need to read the role now to build the menus
    this.currentRole = this.authService.getRole();
    this.setMenuForRole(this.currentRole);
  }

---------

import { inject } from '@angular/core';
import { CanActivateFn, Router } from '@angular/router';
import { AuthService } from '../../features/auth/auth.service';

export const authGuard: CanActivateFn = (route, state) => {
  // We use inject() instead of a constructor for functional guards
  const authService = inject(AuthService);
  const router = inject(Router);

  // If they have a role, let them pass
  if (authService.getRole()) {
    return true; 
  }

  // If they don't have a role, kick them to login and block the route
  router.navigate(['/login']);
  return false; 
};

-------

import { Routes } from '@angular/router';
import { authGuard } from './core/guards/auth.guard'; // <--- 1. Import the guard

export const routes: Routes = [
  { 
    path: 'login', 
    loadComponent: () => import('./features/auth/login/login.component').then(m => m.LoginComponent) 
  },
  { 
    path: 'signup', 
    loadComponent: () => import('./features/auth/signup/signup.component').then(m => m.SignupComponent) 
  },
  { 
    path: 'dashboard', 
    loadComponent: () => import('./features/dashboard/layout/layout.component').then(m => m.LayoutComponent),
    canActivate: [authGuard], // <--- 2. Add the bouncer here! It protects the layout and ALL children.
    children: [
      { path: 'policies', loadComponent: () => import('./features/dashboard/policy-list/policy-list.component').then(m => m.PolicyListComponent) },
      { path: 'apply-claim', loadComponent: () => import('./features/dashboard/apply-claim/apply-claim.component').then(m => m.ApplyClaimComponent) },
      { path: 'approve-claim', loadComponent: () => import('./features/dashboard/approve-claim/approve-claim.component').then(m => m.ApproveClaimComponent) },
      { path: 'create-policy', loadComponent: () => import('./features/dashboard/create-policy/create-policy.component').then(m => m.CreatePolicyComponent) },
      { path: 'manage-users', loadComponent: () => import('./features/dashboard/manage-users/manage-users.component').then(m => m.ManageUsersComponent) },
      { path: '', redirectTo: 'policies', pathMatch: 'full' }
    ]
  },
  { path: '', redirectTo: 'login', pathMatch: 'full' }
];

-----------

ngOnInit() {
    // We only need to read the role now to build the menus
    this.currentRole = this.authService.getRole();
    this.setMenuForRole(this.currentRole);
  }    

-------
// NEW: Replaced Validators.email with a strict Regex Pattern
      email: ['', [
        Validators.required, 
        Validators.pattern('^[a-zA-Z0-9._%+-]+@[a-zA-Z0-9.-]+\\.[a-zA-Z]{2,}$')
      ]],
----

<div class="field-group" style="margin-bottom: 1.5rem;">
          <label for="email" class="field-label" style="display: block; margin-bottom: 0.5rem; font-weight: 600;">Email Address <span class="required-asterisk" style="color: red;">*</span></label>
          <input pInputText id="email" type="email" formControlName="email" placeholder="Enter your email" class="w-full" />
          
          <small class="p-error" *ngIf="signupForm.get('email')?.hasError('required') && signupForm.get('email')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Email is required.</small>
          
          <small class="p-error" *ngIf="signupForm.get('email')?.hasError('pattern') && signupForm.get('email')?.touched" style="color: red; display: block; margin-top: 0.25rem;">Enter a valid email address (e.g., name@domain.com).</small>
        </div>

------------

// NEW: Activate User Request (Superuser only)
  activateUser(userId: number | string, remarks: string): Observable<any> {
    // We expect a plain text response from your Spring Boot controller
    return this.http.post(
      `${this.baseUrl}/auth/activate/${userId}`, 
      { remarks: remarks }, 
      { responseType: 'text' }
    );
  }

------------

import { Component } from '@angular/core';
import { CommonModule } from '@angular/common';
import { FormsModule } from '@angular/forms'; // Needed for the remarks input
import { TableModule } from 'primeng/table';
import { Button } from 'primeng/button';
import { Tag } from 'primeng/tag';
import { Dialog } from 'primeng/dialog';
import { InputTextarea } from 'primeng/inputtextarea';
import { ApiService } from '../../../core/services/api.service';

@Component({
  selector: 'app-manage-users',
  standalone: true,
  imports: [CommonModule, FormsModule, TableModule, Button, Tag, Dialog, InputTextarea],
  templateUrl: './manage-users.component.html'
})
export class ManageUsersComponent {
  // Added 'id' to the mock data to match your backend requirements
  pendingUsers = [
    { id: 1, name: 'Sarah Connor', email: 'sarah@test.com', role: 'Approver' },
    { id: 2, name: 'Kyle Reese', email: 'kyle@test.com', role: 'User' },
    { id: 3, name: 'Miles Dyson', email: 'miles@tech.com', role: 'Read-Only' }
  ];

  displayDialog: boolean = false;
  selectedUser: any = null;
  activationRemarks: string = 'Activated after email verification'; // Default remark

  constructor(private apiService: ApiService) {}

  // Opens the popup
  openActivateDialog(user: any) {
    this.selectedUser = user;
    this.activationRemarks = 'Activated after email verification'; // Reset to default
    this.displayDialog = true;
  }

  // Sends the actual request to Spring Boot
  confirmActivation() {
    if (!this.selectedUser) return;

    this.apiService.activateUser(this.selectedUser.id, this.activationRemarks).subscribe({
      next: (response) => {
        // This will display "User {username} Activated Successfully" OR "User already Active"
        alert(response); 
        this.displayDialog = false;
        
        // Optional: Remove the user from the table after successful activation
        if (response.includes('Successfully') || response.includes('already Active')) {
          this.pendingUsers = this.pendingUsers.filter(u => u.id !== this.selectedUser.id);
        }
      },
      error: (err) => {
        console.error('Activation Error:', err);
        alert('Failed to connect to backend.');
      }
    });
  }
}

---------
<div style="background: white; padding: 2rem; border-radius: 8px; box-shadow: 0 2px 4px rgba(0,0,0,0.05);">
  <h2 style="margin-top: 0; color: #00915a;">User Registrations</h2>
  <p style="color: #666; margin-bottom: 2rem;">Manage and activate new account requests.</p>

  <p-table [value]="pendingUsers" styleClass="p-datatable-striped">
    <ng-template #header>
      <tr>
        <th>ID</th>
        <th>Name</th>
        <th>Email</th>
        <th>Requested Role</th>
        <th>Action</th>
      </tr>
    </ng-template>
    <ng-template #body let-user>
      <tr>
        <td>{{ user.id }}</td>
        <td>{{ user.name }}</td>
        <td>{{ user.email }}</td>
        <td><p-tag [value]="user.role" severity="info"></p-tag></td>
        <td>
          <div style="display: flex; gap: 0.5rem;">
            <p-button label="Activate" icon="pi pi-check" severity="success" size="small" (onClick)="openActivateDialog(user)"></p-button>
            <p-button label="Reject" icon="pi pi-times" severity="danger" size="small" [outlined]="true"></p-button>
          </div>
        </td>
      </tr>
    </ng-template>
  </p-table>

  <p-dialog header="Confirm Activation" [(visible)]="displayDialog" [modal]="true" [style]="{width: '400px'}">
    <div style="margin-bottom: 1.5rem;" *ngIf="selectedUser">
      <p style="margin-top: 0;">Are you sure you want to activate <strong>{{ selectedUser.name }}</strong>?</p>
      
      <label style="font-weight: 600; display: block; margin-bottom: 0.5rem;">Remarks</label>
      <textarea pInputTextarea [(ngModel)]="activationRemarks" rows="3" style="width: 100%;"></textarea>
    </div>
    
    <ng-template #footer>
      <p-button label="Cancel" icon="pi pi-times" (onClick)="displayDialog=false" styleClass="p-button-text"></p-button>
      <p-button label="Confirm Activation" icon="pi pi-check" (onClick)="confirmActivation()" styleClass="p-button-success"></p-button>
    </ng-template>
  </p-dialog>

</div>

