import { Component } from '@angular/core';
import { ReactiveFormsModule, FormBuilder, FormGroup, Validators } from '@angular/forms';
import { HttpClient } from '@angular/common/http';
import { Router } from '@angular/router';
import { DropdownModule } from 'primeng/dropdown';
import { InputTextModule } from 'primeng/inputtext';
import { ButtonModule } from 'primeng/button';
import { CommonModule } from '@angular/common';
import { Store } from '@ngrx/store';
import { setRole } from './store/role.actions';  // Adjust path if needed

@Component({
  selector: 'app-login',
  standalone: true,
  imports: [CommonModule, ReactiveFormsModule, DropdownModule, InputTextModule, ButtonModule],
  templateUrl: './login.html',
  styleUrls: ['./login.css']
})
export class LoginComponent {

  loginForm: FormGroup;
  roles = [
    { label: 'SuperUser', value: 'SuperUser' },
    { label: 'Approver', value: 'Approver' },
    { label: 'User', value: 'User' },
    { label: 'ReadOnly', value: 'ReadOnly' }
  ];

  constructor(private fb: FormBuilder, private http: HttpClient, private router: Router, private store: Store) {
    this.loginForm = fb.group({
      username: ['', Validators.required],
      password: ['', Validators.required],
      role: ['', Validators.required]
    });
  }

  onSubmit() {
    if (this.loginForm.invalid) {
      return;
    }
    this.http.post('http://localhost:8080/api/auth/login', this.loginForm.value).subscribe({
      next: (response: any) => {
        this.store.dispatch(setRole({ role: response.role }));
        this.router.navigate(['/home']);
      },
      error: (error) => {
        alert(error.error);
      }
    });
  }
}

----

<div class="container">
  <h2>Login</h2>
  <form [formGroup]="loginForm" (submit)="onSubmit()">
    <div class="p-field">
      <label for="username">Username:</label>
      <p-inputText id="username" formControlName="username"></p-inputText>
      <small *ngIf="loginForm.get('username')?.invalid" class="p-error">Username is required.</small>
    </div>
    <div class="p-field">
      <label for="password">Password:</label>
      <p-inputText id="password" type="password" formControlName="password"></p-inputText>
      <small *ngIf="loginForm.get('password')?.invalid" class="p-error">Password is required.</small>
    </div>
    <div class="p-field">
      <label for="role">Role:</label>
      <p-dropdown id="role" formControlName="role" [options]="roles" optionLabel="label" optionValue="value"></p-dropdown>
      <small *ngIf="loginForm.get('role')?.invalid" class="p-error">Role is required.</small>
    </div>
    <p-button label="Login" type="submit" [disabled]="loginForm.invalid"></p-button>
  </form>
</div>

-----

.container {
  background-color: white;
  padding: 20px;
  max-width: 400px;
  margin: auto;
  border-radius: 5px;
  box-shadow: 0 2px 5px rgba(0,0,0,0.1);
}

h2 {
  color: #2e7d32;  // Green 600
}

.p-field {
  margin-bottom: 15px;
}

label {
  display: block;
  margin-bottom: 5px;
  color: #333;
}

.p-error {
  color: #f44336;
  font-size: 12px;
}

.p-button {
  background-color: #2e7d32;  // Green 600
  border: none;
}

.p-button:enabled:hover {
  background-color: #1b5e20;  // Green 800
}















